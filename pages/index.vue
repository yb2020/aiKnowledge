<template>
  <div class="sitemap" :class="{'mobile': mobileLayout}">
    <div class="topContent">
      <div class="left">
        <div class="banner">知识就是力量</div>

        <div class="pointerContent">
          
          <div class="item">
            <div class="imgInfo">
              <img class="el-icon-picture-outline image" src="http://5b0988e595225.cdn.sohucs.com/images/20200425/a27d1ce247c849d0bc619ebc49fc0706.jpeg" />
            </div>
            <div class="summary">
              <div class="title">
                <nuxt-link :to="`/paper/2949117887`">
                  世界上最顶尖的光刻机来自荷兰，荷兰的制造工艺
                </nuxt-link>
              </div>
              <div class="content">
                光刻机是顶级科技的合成体，也就是说光刻机决定着现代科技技术先进程度，光刻机是制造纳米芯片的核心设备...
                <el-button style="padding: 0px" type="text">阅读全文<i :class="'el-icon-caret-bottom'" /></el-button>
                <div class="link">
                  <el-button type="primary" size="mini" icon="el-icon-caret-top">赞同3.6万</el-button>
                  <el-button type="text" size="mini" icon="el-icon-s-comment" style="color: #888888; font-weight: normal;">79条评论</el-button>
                  <el-button type="text" size="mini" icon="el-icon-share" style="color: #888888; font-weight: normal;">分享</el-button>
                  <el-button type="text" size="mini" icon="el-icon-star-on" style="color: #888888; font-weight: normal;">收藏</el-button>
                  <div class="time">04-06</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="item">
            <div class="imgInfo">
              <img class="el-icon-picture-outline image" src="http://5b0988e595225.cdn.sohucs.com/images/20200511/898cc440f6f24672baa640ebcf7b8333.jpeg" />
            </div>
            <div class="summary">
              <div class="title">
                <nuxt-link :to="`/paper/2949117887`">
                  正式打破国外封锁！国产电脑系统宣布：个人用户永久免费使用
                </nuxt-link>
              </div>
              <div class="content">
                中国目前的科技技术发展飞速，很多领域都已经走到了世界前列，但是有很多核心技术我们还没有掌握，比如像是Windows...
                <el-button style="padding: 0px" type="text">阅读全文<i :class="'el-icon-caret-bottom'" /></el-button>
                <div class="link">
                  <el-button type="primary" size="mini" icon="el-icon-caret-top">赞同3.6万</el-button>
                  <el-button type="text" size="mini" icon="el-icon-s-comment" style="color: #888888; font-weight: normal;">79条评论</el-button>
                  <el-button type="text" size="mini" icon="el-icon-share" style="color: #888888; font-weight: normal;">分享</el-button>
                  <el-button type="text" size="mini" icon="el-icon-star-on" style="color: #888888; font-weight: normal;">收藏</el-button>
                  <div class="time">04-06</div>
                </div>
              </div>
            </div>
          </div>

          <div class="item">
            <div class="summary onLeftPadding">
              <div class="title">
                <nuxt-link :to="`/paper/2949117887`">
                 ICLR 2019最佳论文出炉：微软、MILA、MIT获奖
                </nuxt-link>
              </div>
              <div class="content">
                深度学习顶会 ICLR 2019 的两篇最佳论文现已放出，来自蒙特利尔大学、微软研究院和 MIT CSAIL 的研究者获得了最佳论文奖。其中一篇最佳论文探讨自然语言处理问题...
                <el-button style="padding: 0px" type="text">阅读全文<i :class="'el-icon-caret-bottom'" /></el-button>
                <div class="link">
                  <el-button type="primary" size="mini" icon="el-icon-caret-top">赞同3.6万</el-button>
                  <el-button type="text" size="mini" icon="el-icon-s-comment" style="color: #888888; font-weight: normal;">79条评论</el-button>
                  <el-button type="text" size="mini" icon="el-icon-share" style="color: #888888; font-weight: normal;">分享</el-button>
                  <el-button type="text" size="mini" icon="el-icon-star-on" style="color: #888888; font-weight: normal;">收藏</el-button>
                  <div class="time">04-06</div>
                </div>
              </div>
            </div>
          </div>

          <div class="item">
            <div class="imgInfo">
              <img class="el-icon-picture-outline image" src="http://5b0988e595225.cdn.sohucs.com/images/20200511/0e76de5201fe4863a79086ae84a89d42.jpeg" />
            </div>
            <div class="summary">
              <div class="title">
                <nuxt-link :to="`/paper/2949117887`">
                  2020年，5种将死的编程语言，不要浪费时间去学习了
                </nuxt-link>
              </div>
              <div class="content">
                2020年，5种将死的编程语言，不要浪费时间去学习了。曾几何时，几乎每个人都在使用Perl语言编程。但是那些经常使用的人慢慢地发现，关于这个...
                <el-button style="padding: 0px" type="text">阅读全文<i :class="'el-icon-caret-bottom'" /></el-button>
                <div class="link">
                  <el-button type="primary" size="mini" icon="el-icon-caret-top">赞同3.6万</el-button>
                  <el-button type="text" size="mini" icon="el-icon-s-comment" style="color: #888888; font-weight: normal;">79条评论</el-button>
                  <el-button type="text" size="mini" icon="el-icon-share" style="color: #888888; font-weight: normal;">分享</el-button>
                  <el-button type="text" size="mini" icon="el-icon-star-on" style="color: #888888; font-weight: normal;">收藏</el-button>
                  <div class="time">04-06</div>
                </div>
              </div>
            </div>
          </div>

        </div>
        <!-- <div class="pointerContent">
          <div class="item" v-for="(paper,index) in searchResult.list" :key="index">
            <div class="imgInfo">
              <i class="el-icon-picture-outline image"></i>
              <div class="info">
                <div>作者：何开明</div>
                <div>期刊：XX</div>
              </div>
            </div>
            <div class="summary">
              <nuxt-link :to="`/paper/${paper.id}`">
              <div class="title">
                {{paper.title}}
              </div>
              <div class="content">
                {{paper.summary}}
              </div>
              </nuxt-link>
            </div>
          </div>
        </div> -->

        <div class="communityContent">
          <div class="title">社区热点追踪</div>
          <div class="content">
            <div class="item" v-for="(discuss, index) in discusses.data" :key="discuss.id">
              <div class="communityTitle">{{discuss.title}}</div>
              <div class="text">
                {{discuss.content}}
                <el-button style="padding: 0px" @click="toggleShow(index)" v-if="!discuss.isFull" type="text">{{discuss.displayShort ? "阅读全文" : "收起全文"}}<i :class="discuss.displayShort ? 'el-icon-caret-bottom' : 'el-icon-caret-top'" /></el-button>
              </div>
              <div class="link">
                <el-button type="primary" size="mini" icon="el-icon-caret-top">赞同3.6万</el-button>
                <el-button type="text" size="mini" icon="el-icon-s-comment" style="color: #888888; font-weight: normal;">79条评论</el-button>
                <el-button type="text" size="mini" icon="el-icon-share" style="color: #888888; font-weight: normal;">分享</el-button>
                <el-button type="text" size="mini" icon="el-icon-star-on" style="color: #888888; font-weight: normal;">收藏</el-button>
                <div class="time">{{ discuss.createDate | dateFormat('MM-dd') }}</div>
              </div>
            </div>
          </div>
        </div>

      </div>


      <div class="right">

        <div class="statisticsPanel">
          <div class="item blue" @click="forward('Publications')">
            <div class="icon"><i class="el-icon-document" /></div>
            <div class="rightText">
              <div class="number">233,467,597</div>
              <div class="text">论文</div>
            </div>
          </div>

          <div class="item red" @click="forward('Authors')">
            <div class="icon"><i class="el-icon-user-solid" /></div>
            <div class="rightText">
              <div class="number">238,949,598</div>
              <div class="text">作者</div>
            </div>
          </div>

          <div class="item green" @click="forward('Topics')">
            <div class="icon"><i class="el-icon-s-help" /></div>
            <div class="rightText">
              <div class="number">710,937</div>
              <div class="text">会议</div>
            </div>
          </div>
          
          <div class="item blue" @click="forward('Journals')">
            <div class="icon"><i class="el-icon-location" /></div>
            <div class="rightText">
              <div class="number">4,456</div>
              <div class="text">期刊</div>
            </div>
          </div>

          <div class="item red" @click="forward('Journals')">
            <div class="icon"><i class="el-icon-notebook-1" /></div>
            <div class="rightText">
              <div class="number">48,858</div>
              <div class="text">学科</div>
            </div>
          </div>

          <div class="item green" @click="forward('Institutions')">
            <div class="icon"><i class="el-icon-school" /></div>
            <div class="rightText">
              <div class="number">25,562</div>
              <div class="text">大学</div>  
            </div>
          </div>

        </div>

        <transition name="fade" mode="">
          <my-footer v-if="!isError && !isWelcome"></my-footer>        
        </transition>

      </div>
    </div>

  </div>
</template>

<script>

import myFooter from '~/components/layouts/footer'

export default {
  name: 'sitemap',

  scrollToTop: true,

  transition: 'fade',

  components: {
    myFooter
  },

  head() {
    return {
      title: this.option.title,
      meta: [
        {
          hid: 'keywords',
          name: 'keywords',
          content: this.keywords
        },
        {
          hid: 'og:title',
          name: 'og:title',
          content: this.option.title
        },
        {
          hid: 'og:type',
          name: 'og:type',
          content: 'app'
        },
        {
          hid: 'description',
          name: 'description',
          content: this.option.description
        },
        {
          hid: 'og:description',
          name: 'og:description',
          content: this.option.description
        },
        {
          hid: 'content',
          name: 'content',
          content: this.option.content
        },
        {
          name: 'Copyright',
          content: this.option.author + "版权所有"
        },
        {
          name: 'author',
          content: this.option.author
        }
      ],
      link: [
        {
          hid: 'shortcut icon',
          rel: 'shortcut icon',
          href: this.option.staticDomain + this.option.icon
        },
        {
          hid: 'icon',
          rel: 'icon',
          href: this.option.staticDomain + this.option.icon
        }
      ]
    }
  },

  async fetch ({ store }) {
    let result1 = await store.dispatch('discuss/getDiscusses', { pageSize: 10 })
    let result2 = await store.dispatch('search/searchPaper', {pageSize: 3})
    return {
      result1,
      result2
    }
  },

  computed: {
    searchResult() {
      return this.$store.state.search.data
    },
    discusses () {
      const discusses = this.$store.state.discuss.data
      this.result.total = discusses.total
      this.result.currentPage = discusses.pageNum
      this.result.pageSize = discusses.pageSize
      this.result.data = JSON.parse(JSON.stringify(discusses.list)) // 断开引用
      return this.result
    },
    tag () {
      console.log(this.$store.state.tag.data)
      return this.$store.state.tag.data
    },

    isWelcome () {
      return false;
    },

    isError () {
      return this.$store.state.options.isError
    },

    option () {
      return this.$store.state.options.option
    },

    mobileLayout () {
      return this.$store.state.options.mobileLayout
    },

    yearMap () {
      return this.$store.state.sitemap.art
    }
  },

  filters: {
    monthFilter (val) {
    //   val = parseInt(val)
    //   switch (val) {
    //     case 1: return 'January'
    //     case 2: return 'February'
    //     case 3: return 'March'
    //     case 4: return 'April'
    //     case 5: return 'May'
    //     case 6: return 'June'
    //     case 7: return 'July'
    //     case 8: return 'August'
    //     case 9: return 'September'
    //     case 10: return 'October'
    //     case 11: return 'November'
    //     case 12: return 'December'
    //   }
      return val
    }
  },
  data() {
    return {
      searchValue: '',
      restaurants: [{ "value": "樱花食堂（凌空店）", "address": "上海市长宁区金钟路968号15楼15-105室" },
          { "value": "壹分米客家传统调制米粉(天山店)", "address": "天山西路428号" },
          { "value": "福荣祥烧腊（平溪路店）", "address": "上海市长宁区协和路福泉路255弄57-73号" },
          { "value": "速记黄焖鸡米饭", "address": "上海市长宁区北新泾街道金钟路180号1层01号摊位" },
          { "value": "红辣椒麻辣烫", "address": "上海市长宁区天山西路492号" },
          { "value": "(小杨生煎)西郊百联餐厅", "address": "长宁区仙霞西路88号百联2楼" },
          { "value": "阳阳麻辣烫", "address": "天山西路389号" },
          { "value": "南拳妈妈龙虾盖浇饭", "address": "普陀区金沙江路1699号鑫乐惠美食广场A13" }],
      result: {
        data: [],
        currentPage: 1,
        pageSize: 8,
        pageSizes: [8, 10, 12],
        total: 0
      },
    }
  },
  methods: {
    toggleShow(index) {
      this.$store.dispatch('discuss/toggleShow', index)
    },
    goType(item) {
      let route = '/code';
      if (item.type === 2) route = '/think';
      if (item.type === 3) route = 'fuck';
      this.$router.push(route);
    },
    forward(page) {
      let route = ""
      switch(page) {
        case 'Publications': 
          route = "publications"
          this.$router.push("/search/publications" );
          return ;
        case 'Topics': 
          route = "topics"
        break ;
        case 'Authors': 
          route = "authors"
        break ;
        case 'Conferences': 
          route = "conferences"
        break ;
        case 'Journals': 
          route = "journals"
        break ;
        case 'Institutions': 
          route = "institutions"
        break ;
        default: 
      }
      this.$router.push(route + "/1" );

    },
    handleSelect(item) {
      console.log(item);
    },
    querySearch(queryString, cb) {
      var restaurants = this.restaurants;
      var results = queryString ? restaurants.filter(this.createFilter(queryString)) : restaurants;
      // 调用 callback 返回建议列表的数据
      cb(results);
    },
    createFilter(queryString) {
      return (restaurant) => {
        return (restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);
      };
    },
    search() {
      this.$router.push(`/search/${this.searchValue}`)
      this.searchValue = ''
    }
  }
}
</script>

<style scoped lang="scss">
.sitemap {
  margin: 0 auto;

  .topContent {
    margin:auto ;
    margin-top: 10px ;
    width: 1000;
    display: flex;
    display: -webkit-flex; /* Safari */
    justify-content: space-around;


    .left {
      width: 700px ;

      .banner {
        height: 5rem;
        background: $blue ;
        border-radius: 4px ;
        font-size: 40px ;
        text-align: center ;
        align-content: center ;
        line-height: 5rem ;
        color: #FFFFFF ;
      }

      .pointerContent {
        margin-top: 10px ;
        background: #FFFFFF ;
        border-radius: 2px ;
        box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.03);


        .item {
          padding: 16px 20px;
          border-bottom: 1px solid #F0F0F0;
          display: flex;
          display: -webkit-flex; /* Safari */
          justify-content: space-between;

          .imgInfo {
            width: 6rem;
            .image {
              width: 6rem ;
              height: 6rem ;
              border: 1px solid #f0f0f0;
              border-radius: 4px;
              font-size: 6rem;
              color: #aaaaaa ;
            }
            .info {
              font-size: 14px;
              padding-top: 10px ;
              div {
                line-height: 24px ;
              }
            }
          }
          .summary {
            padding-left: 1rem ;

            .title {
              font-size: 16px ;
              font-weight: bolder;
            }
            
            a:hover { 
              color: #ff0000 ;
              text-decoration: underline;
            }

            .content {
              padding: 5px ;
              text-indent: 28px;
              font-size: 14px;
              line-height: 24px;
              height: 100px;
              overflow: hidden;
              text-overflow: ellipsis;
              .link {
                text-indent: 0px ;
                padding-top: 10px;
                font-size: 12px ;
                display: flex;
                display: -webkit-flex; /* Safari */
                justify-content: flex-start ;
                align-items: center ;
                .time {
                  color: rgb(136, 136, 136);
                  padding-left: 10px ;
                }
              }
            }
          }
          .onLeftPadding {
            padding-left: 0px ;
          }
        }
      }

      .communityContent {
        margin:auto ;
        margin-top: 10px ;

        .title {
          background: $blue ;
          text-align: center ;
          color: #FFFFFF ;
          padding: 10px 0px ;
          border-radius: 2px 2px 0px 0px ;
        }
        .content {
          background: #FFFFFF ;
          .item {
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0 ;

            .communityTitle {
              text-align: left;
              color: #333333 ;
              font-size: 16px ;
              font-weight: bolder;
              padding: 0px ;
              padding-top: 10px ;
            }
            .text {
              padding: 10px 0px ;
              font-size: 14px;
              line-height: 22px;
              text-indent: 28px;
            }
            .link {
              font-size: 12px ;
              color: #888 ;
              display: flex;
              align-items: center;
              i {
                font-size: 12px ;
              }
              .time {
                display: inline;
                padding-left: 10px ;
              }
            }
          }

          .item:hover {
            background: #f0f0f0;
          }
        }
      }



    }

    .right {
      width: 300px;
      margin-left: 10px ;

      .statisticsPanel {
        background: #FFFFFF ;
        border-radius: 2px ;
        box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.03);

        .item {
          display: flex;
          display: -webkit-flex; /* Safari */
          justify-content: left;
          padding: 20px;

          .icon {
            background: #c7e3fe;
            border-radius: 50%;
            width: 3rem ;
            height: 3rem ;
            text-align: center;
            i {
              padding: .4rem;
              font-size: 1.8em;
              vertical-align: middle;
            }
          }

          .rightText {
            padding-left: 10px;

            .number {
              font-size: 1.2rem;
            }
            .text {
              font-size: 0.8rem;
              font-style: italic;
            }
          }
        }
        .blue {
            .icon {
              background: #c7e3fe;
            }
            i {
              color: $blue;
            }
            .rightText {
              color: $blue;
            }
          }
          .red {
            .icon {
              background: #fef0f0;
            }
            i {
              color: #f36d6f;
            }
            .rightText {
              color: #f36d6f;
            }
          }
          .green {
            .icon {
              background: #f0f9ec;
            }
            i {
              color: #6ac144;
            }
            .rightText {
              color: #6ac144;
            }
          }
        .item:hover {
          background: #f9f9f9;
          cursor: pointer;
        }

      }
      
      .title {
        color: $blue;
        font-size: 16px;
        padding-bottom: 8px;
      }

      .content {
        border: 0px ;
        margin-top: 10px;
        width: auto;
        display: flex;
        display: -webkit-flex; /* Safari */
        justify-content: space-around;

        .box-card {
          width: 50% ;
          margin: 0px 10px ;
        }

        .item {
          background: #ffffff;
          width: 100%;
          height: 20%;
          border-bottom: 1px solid #f0f0f0;
          display: flex;
          display: -webkit-flex; /* Safari */
          justify-content: left;
          .icon {
            padding: 14px;
            i {
              font-size: 3em;
              color: $blue;
              vertical-align: middle;
            }
          }
          .rightText {
            padding-top: 10px;

            .number {
              font-size: 1.5rem;
            }
            .text {
              font-size: 0.8rem;
              font-style: italic;
            }
          }
        }
        .item:hover {
          background: #f9f9f9;
          cursor: pointer;
        }

      }
    }
    
  }


}

</style>
